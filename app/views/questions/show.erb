<h1><%= @question.title %></h1>

<%= erb(:_errors) %>

<article class='question-container'>
  <p>
    <a href="/questions/<%= @question.id %>/upvote">Upvote</a></br>
    <%= @question.points %> points </br>
    <a href="/questions/<%= @question.id %>/downvote">Downvote</a></br>
    by <%= @author.username %> </br>
    <b>body:</b>
    <%= @question.body %>
  </p>
  <% if logged_in? %>
    <a class="question-comment-link" href="/questions/<%= @question.id %>/comments/new">Comment</a>
    <form id="new_question_comment_form" action="/comments" method="post" class="hidden">
      <input type="text" name="body" placeholder="Put your comment here!"></br>
      <input type = "hidden" name="commentable_id" value="<%= @question.id %>">
      <input type = "hidden" name="commentable_type" value="<%= @question.class %>">
      <input type="submit" class="button" value="Submit">
    </form>
  <% end %>
  <% if @question_comments %>
  <ul class="question_comments">
  <% @question_comments.each do |comment| %>
    <%= erb :'/comments/_comment', locals: {comment: comment}, layout: false %>
  <% end%>
  </ul>
  <% end %>
</article>

<% if logged_in? %>
<form action="/answers" method="post">
  <input type="text" name="answer[body]" placeholder="Put your answer details here!"></br>
  <input type = "hidden" name="answer[question_id]" value="<%= @question.id %>">
  <input type="submit" class="button" value="Submit">
</form>
<% end %>

<% if @answers %>
  <% if @best_answer %>

<article class="best-answer-container">

  <p>
    <%= @best_answer.body %></br>
    by <%= @best_answer.user.username %>
  </p>
</article>

<% end %>
<% end %>


<% if logged_in? %>
  <a class="best-answer-comment-link" href="/answers/<%= @best_answer.id %>/comments/new">Comment</a>
  <form action="/comments" method="post" class="hidden new_best_answer_comment_form">
    <input class="best-answer-comment" type="text" name="body" placeholder="Put your comment here!"></br>
    <input type = "hidden" name="commentable_id" value="<%= @best_answer.id %>">
    <input type = "hidden" name="commentable_type" value="<%= @best_answer.class %>">
    <input type="submit" class="button" value="Submit">
  </form>
<% end %>
<% if @best_answer.comments %>
<ul class="best_answer_comments">
<% @best_answer.comments.order(created_at: :asc).each do |comment| %>
  <%= erb :'/comments/_comment', locals: {comment: comment}, layout: false %>
<% end %>
</ul>

<% end %>
  <% end %>

<div id="answer-container" class="answer-container">
  <% @answers.each do |answer| %>
    <article id="<%= answer.id %>">
      <%= answer.body %> </br>
      <a href="/answers/<%= answer.id %>/upvote">Upvote</a></br>
      <%= answer.points %> points </br>
      <a href="/answers/<%= answer.id %>/downvote">Downvote</a></br>
      <b>by <%= answer.user.username %></b>

      <% if current_user.id == answer.question.user.id %>
        <form action="/question/<%= answer.question.id %>/best" method="post">
          <input type="hidden" name="answer_id" value="<%= answer.id %>">
          <input type="submit" class="button" value="Best Answer">
        </form>
      <% end %>

      <% if logged_in? %>
        <a class="answer-comment-link" href="/answers/<%= answer.id %>/comments/new">Comment</a>
        <form action="/comments" method="post" class="hidden new_answer_comment_form">
          <input class="answer-comment" type="text" name="body" placeholder="Put your comment here!"></br>
          <input type = "hidden" name="commentable_id" value="<%= answer.id %>">
          <input type = "hidden" name="commentable_type" value="<%= answer.class %>">
          <input type="submit" class="button" value="Submit">
        </form>
      <% end %>

      <% if answer.comments %>
      <ul class="answer_comments">
      <% answer.comments.order(created_at: :asc).each do |comment| %>
        <%= erb :'/comments/_comment', locals: {comment: comment}, layout: false %>
      <% end %>
      </ul>

    <% end %>
  </article>

  <% end%>
  </div>
<% end %>
